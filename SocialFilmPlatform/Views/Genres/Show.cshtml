@model SocialFilmPlatform.Models.Genre

@{
    ViewBag.Title = Model.GenreName;
    var backdropUrl = "https://images.unsplash.com/photo-1723396612574-961649793bb9?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D";  
}

<style>
    @@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:ital,wght@0,300;0,400;1,400&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap');

    :root {
        --hollywood-bg: #fdfbf7;
        --hollywood-text: #1a1a1a;
        --hollywood-gold: #c4a055;
        --hollywood-gray: #555;
        --font-display: 'Cinzel', serif;
        --font-body: 'Lato', sans-serif;
        --font-heading: 'Playfair Display', serif;
    }

    body {
        background-color: var(--hollywood-bg);
        color: var(--hollywood-text);
        font-family: var(--font-body);
    }

    /* Hero Section */
    .hero-archive {
        position: relative;
        height: 50vh;
        min-height: 400px;
        background-image: url('@Html.Raw(backdropUrl)');
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: flex-end;
        margin-bottom: 4rem;
        width: 100vw;
        margin-left: calc(-50vw + 50%);
    }

    .hero-archive::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(to top, var(--hollywood-bg) 5%, rgba(253, 251, 247, 0.8) 20%, rgba(0,0,0,0) 100%);
    }

    .hero-content {
        position: relative;
        z-index: 2;
        padding-bottom: 2rem;
        width: 100%;
    }

    .genre-title-large {
        font-family: var(--font-display);
        font-size: 4rem;
        line-height: 1;
        margin-bottom: 0.5rem;
        color: #000;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    .meta-line {
        font-family: var(--font-heading);
        font-size: 1.2rem;
        color: var(--hollywood-gray);
        font-style: italic;
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .section-title {
        font-family: var(--font-display);
        font-size: 1.5rem;
        border-bottom: 1px solid #ddd;
        padding-bottom: 0.5rem;
        margin-bottom: 2rem;
        font-weight: 700;
        color: var(--hollywood-text);
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    
    .section-title::after {
        content: '';
        flex-grow: 1;
        height: 1px;
        background: #ddd;
    }

    .btn-archive {
        background: transparent;
        border: 1px solid #333;
        color: #333;
        font-family: var(--font-display);
        padding: 0.5rem 1.5rem;
        letter-spacing: 1px;
        transition: all 0.3s;
        border-radius: 0;
        text-transform: uppercase;
        font-size: 0.8rem;
        text-decoration: none;
        display: inline-block;
    }

    .btn-archive:hover {
        background: #111;
        color: #fff;
    }

    /* Movie Cards from Index Style */
    .movie-card-vintage {
        background: transparent;
        border: none;
        transition: transform 0.3s;
    }

    .movie-card-vintage:hover {
        transform: translateY(-5px);
    }
    
    .card-img-wrapper {
        position: relative;
        overflow: hidden;
        margin-bottom: 1rem;
        aspect-ratio: 2/3;
    }

    .card-img-vintage {
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: sepia(20%) contrast(95%);
        transition: filter 0.3s, transform 0.5s;
    }

    .movie-card-vintage:hover .card-img-vintage {
        filter: sepia(0%) contrast(100%);
        transform: scale(1.03);
    }

    .card-title-vintage {
        font-family: var(--font-display);
        font-size: 1.1rem;
        margin-bottom: 0.3rem;
        color: #000;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        text-decoration: none;
    }

    .card-meta {
        font-family: var(--font-body);
        font-size: 0.85rem;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    /* Sidebar */
    .archive-stats {
        border-left: 1px solid #ddd;
        padding-left: 2rem;
    }
    
    .stat-item {
        margin-bottom: 1.5rem;
    }
    
    .stat-label {
        font-family: var(--font-display);
        font-size: 0.75rem;
        color: #888;
        text-transform: uppercase;
        display: block;
        margin-bottom: 0.3rem;
    }
    
    .stat-value {
        font-family: var(--font-heading);
        font-size: 1.1rem;
        color: #000;
    }
</style>

<div class="hero-archive">
    <div class="container hero-content">
        <div class="row">
            <div class="col-lg-8">
                <div class="meta-line mb-3">
                    <span>Archive Collection</span>
                    <span>&bull;</span>
                    <span>Category</span>
                </div>
                
                <h1 class="genre-title-large">@Model.GenreName</h1>
                
                <div class="mt-4 d-flex gap-3">
                    @if (User.IsInRole("Admin") || User.IsInRole("Editor"))
                    {
                        <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-archive">
                            EDIT CATEGORY
                        </a>
                        <form asp-action="Delete" asp-route-id="@Model.Id" method="post" class="d-inline">
                            <button type="submit" class="btn btn-archive text-danger border-danger"
                                    onclick="return confirm('Archive deletion is permanent. Proceed?');">
                                DELETE
                            </button>
                        </form>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container pb-5">
    <div class="row gx-5">
        <!-- Main Content -->
        <div class="col-lg-9 content-wrapper">
            <section class="mb-5">
                <h3 class="section-title">Films in this Category (@(Model.Movies?.Count() ?? 0))</h3>
                
                @if (Model.Movies == null || !Model.Movies.Any())
                {
                    <div class="text-center py-5 text-muted fst-italic">
                        <p>No films archived in this category yet.</p>
                    </div>
                }
                else
                {
                    <div class="row row-cols-1 row-cols-md-3 g-4">
                        @foreach (var movie in Model.Movies)
                        {
                            var posterUrl = string.IsNullOrEmpty(movie.ImageUrl) 
                                ? "https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?q=80&w=500&auto=format&fit=crop" 
                                : movie.ImageUrl;
                                
                            <div class="col">
                                <div class="movie-card-vintage h-100">
                                    <a asp-controller="Movies" asp-action="Show" asp-route-id="@movie.Id" class="text-decoration-none">
                                        <div class="card-img-wrapper">
                                            <img src="@posterUrl" class="card-img-vintage" alt="@movie.Title">
                                        </div>
                                        <div class="text-center">
                                            <h5 class="card-title-vintage text-truncate">@movie.Title</h5>
                                            <div class="card-meta">
                                                <span>@movie.ReleaseDate.ToString("yyyy")</span>
                                            </div>
                                            <div class="mt-1 text-warning small">
                                                <i class="bi bi-star-fill"></i> @movie.Score
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        }
                    </div>
                }
            </section>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-3 archive-stats d-none d-lg-block">
            <div>
                <div class="stat-item">
                    <span class="stat-label">Category Name</span>
                    <span class="stat-value">@Model.GenreName</span>
                </div>
                
                <div class="stat-item">
                    <span class="stat-label">Total Films</span>
                    <span class="stat-value">@(Model.Movies?.Count ?? 0)</span>
                </div>
                
                <div class="mt-5">
                    <a asp-action="Index" class="btn btn-archive w-100 text-center">
                        RETURN TO GENRES
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>